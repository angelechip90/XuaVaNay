<app-header [title]="'account.title' | translate"></app-header>

<!-- Content -->
<ion-content [fullscreen]="true">
  <div class="container">
    <!-- Avatar + tên + trạng thái -->
    <section class="hero">
      <div class="avatar-wrap">
        <div class="avatar" (click)="changeAvatar($event)">
          <img [src]="userInfo().Avatar || '/assets/image/default-avatar.png'" alt="Avatar" />
          <div class="overlay">
            <ion-icon name="camera-outline"></ion-icon>
          </div>
        </div>
      </div>

      <div class="title-block">
        <h1>{{ userInfo().FullName }}</h1>
        <p>
          {{ 'account.usingPlan' | translate:{ plan: (userInfo().ActiveSubscription?.SubscriptionPlan?.Name || '') } }}
          {{ 'account.until' | translate:{ date: ((userInfo().ActiveSubscription?.EndDate) | date:'dd/MM/yyyy') } }}
        </p>
        <div class="ion-text-center">
          <div class="plan-badge" *ngIf="userInfo().ActiveSubscription?.SubscriptionPlan?.PlanType !== 0; else upgrade">
            <div class="ion-align-items-center">
              <ion-icon name="diamond-outline"></ion-icon>
            </div>
            <div class="badge-text">{{ userInfo().ActiveSubscription?.SubscriptionPlan?.Name }}</div>
          </div>
          <ng-template #upgrade>
            <div class="plan-badge" (click)="openUpgrade()">
              <div class="badge-text">{{ 'account.upgrade' | translate }}</div>
            </div>
          </ng-template>
        </div>
      </div>
    </section>

    <!-- Items -->
    <section class="list">
      <app-language></app-language>
      <div class="divider"></div>
      <!-- Email -->
      <div class="row" (click)="openEmail()">
        <div class="icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M21 15.0944C21 17.8596 19.1552 20.1072 16.4183 20.1004H7.58173C4.84476 20.1072 3 17.8596 3 15.0944V8.91315C3 6.15088 4.84476 3.90039 7.58173 3.90039H16.4183C19.1552 3.90039 21 6.15088 21 8.91315V15.0944Z"
              stroke="#130261" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            <path d="M17.3046 8.91016L13.3057 12.1618C12.5526 12.7602 11.4853 12.7602 10.7322 12.1618L6.69922 8.91016"
              stroke="#130261" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            <path d="M9.96256 11.542L6.69531 15.0904M17.3056 15.0909L14.0743 11.5425" stroke="#130261"
              stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
          </svg>

        </div>
        <div class="label">{{ 'account.email' | translate }}</div>
        <div class="value accent">{{ userInfo().Email }}</div>
        <div class="chev">
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </div>
      </div>
      <div class="divider"></div>

      <!-- Sách đã đọc -->
      <div class="row" (click)="openReadBooks()">
        <div class="icon">
          <svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M9.96094 0C7.48535 0 5.46094 2.02441 5.46094 4.5C5.46094 5.25586 5.64551 5.95898 5.97656 6.58594C4.6084 6.25195 2.94141 6 0.960938 6H0L2.625 16.5H3.21094C5.76562 16.5 7.33594 16.8662 8.25 17.2031C8.70703 17.373 8.99707 17.54 9.16406 17.6484C9.33105 17.7568 9.35156 17.7656 9.35156 17.7656L9.5625 18H10.3594L10.5703 17.7656C10.5703 17.7656 10.5908 17.7568 10.7578 17.6484C10.9248 17.54 11.2148 17.373 11.6719 17.2031C12.5859 16.8662 14.1562 16.5 16.7109 16.5H17.2969L19.9219 6H18.9609C16.9893 6 15.3252 6.2373 13.9688 6.5625C14.291 5.94434 14.4609 5.24414 14.4609 4.5C14.4609 2.02441 12.4365 0 9.96094 0ZM9.96094 1.5C11.6279 1.5 12.9609 2.83301 12.9609 4.5C12.9609 6.16699 11.6279 7.5 9.96094 7.5C8.29395 7.5 6.96094 6.16699 6.96094 4.5C6.96094 2.83301 8.29395 1.5 9.96094 1.5ZM1.94531 7.59375C4.27734 7.70801 6.18164 8.1123 7.42969 8.57812C8.43457 8.95312 8.92969 9.24316 9.21094 9.42188V15.9844C9.07617 15.9229 8.95312 15.8584 8.78906 15.7969C7.77539 15.4219 6.11133 15.1055 3.79688 15.0469L1.94531 7.59375ZM17.9766 7.59375L16.125 15.0469C13.8105 15.1055 12.1465 15.4219 11.1328 15.7969C10.9688 15.8584 10.8457 15.9229 10.7109 15.9844V9.42188C10.9922 9.24023 11.4844 8.94727 12.4688 8.57812C13.708 8.1123 15.6152 7.70801 17.9766 7.59375Z"
              fill="#1B2559" />
          </svg>
        </div>
        <div class="label">{{ 'account.readBooks' | translate }}</div>
        <div class="value">{{ totalBookRead}}</div>
        <div class="chev">
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </div>
      </div>
      <div class="divider"></div>

      <!-- Lịch sử Hỏi Đáp -->
      <div class="row" (click)="openQaHistory()">
        <div class="icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M8.72508 10.5645H15.4456M8.67188 14.4657H12.0584M8.20753 20.2229C11.5395 21.7691 15.6139 21.1727 18.3641 18.4132C21.8752 14.8902 21.882 9.17194 18.3641 5.64219C14.8531 2.11927 9.14828 2.11927 5.63626 5.64219C2.88697 8.40176 2.29158 12.4899 3.83356 15.8332C4.03105 16.3271 4.18476 16.7254 4.18476 17.111C4.18476 18.1886 3.14867 19.523 3.8394 20.2161C4.53013 20.9092 5.86099 19.8696 6.92822 19.8637C7.3125 19.8637 7.71526 20.0238 8.20753 20.2229Z"
              stroke="#1B2559" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </div>
        <div class="label">{{ 'account.qaHistory' | translate }}</div>
        <div class="value">{{ totalHistory}}</div>
        <div class="chev">
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </div>
      </div>
      <div class="divider"></div>

      <!-- Lịch sử mua gói đọc -->
      <div class="row" (click)="openPurchaseHistory()">
        <div class="icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M19.4622 8.67354L17.5987 6.81004V4.16478C17.5987 3.6826 17.4072 3.22017 17.0662 2.87922C16.7253 2.53827 16.2629 2.34673 15.7807 2.34673H13.1445L11.281 0.528676C10.9404 0.190062 10.4796 0 9.99928 0C9.51898 0 9.05819 0.190062 8.71756 0.528676L6.85405 2.35582H4.20879C3.72661 2.35582 3.26418 2.54736 2.92323 2.88831C2.58228 3.22926 2.39074 3.69169 2.39074 4.17387V6.81004L0.572687 8.67354C0.39704 8.83856 0.255956 9.03686 0.15764 9.2569C0.0593241 9.47694 0.0057388 9.71433 5.79697e-07 9.95527C-0.00038254 10.4354 0.18915 10.8961 0.527235 11.237L2.39983 13.1005V15.7458C2.39983 16.2279 2.59137 16.6904 2.93232 17.0313C3.27327 17.3723 3.7357 17.5638 4.21788 17.5638H6.85405L8.71756 19.4273C9.05842 19.7654 9.51918 19.9549 9.99928 19.9545C10.4794 19.9549 10.9401 19.7654 11.281 19.4273L13.1445 17.5547H15.7898C16.2719 17.5547 16.7344 17.3632 17.0753 17.0222C17.4163 16.6813 17.6078 16.2188 17.6078 15.7367V13.1005L19.4713 11.237C19.8099 10.8964 20 10.4356 20 9.95527C20 9.47497 19.8099 9.01418 19.4713 8.67354H19.4622ZM15.7807 12.3551V15.7367H12.3991L9.99928 18.1365L7.59945 15.7367H4.21788V12.3551L1.81805 9.95527L4.21788 7.55544V4.17387H7.59945L9.99928 1.77404L12.3991 4.17387H15.7807V7.55544L18.1805 9.95527L15.7807 12.3551Z"
              fill="#1B2559" />
            <path
              d="M9.09038 10.6185L7.00871 8.5368L5.7179 9.81853L9.09038 13.191L14.2809 8.00048L12.9901 6.71875L9.09038 10.6185Z"
              fill="#1B2559" />
          </svg>
        </div>
        <div class="label">{{ 'account.purchaseHistory' | translate }}</div>
        <div class="value"></div>
        <div class="chev">
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </div>
      </div>
      <div class="divider"></div>

      <!-- Đổi mật khẩu -->
      <div class="row" (click)="openChangePassword()">
        <div class="icon">
          <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M11.8 7.3V3.88C11.8 3.11618 11.4207 2.38364 10.7456 1.84353C10.0704 1.30343 9.15475 1 8.19998 1C7.2452 1 6.32952 1.30343 5.65439 1.84353C4.97926 2.38364 4.59998 3.11618 4.59998 3.88V7.3"
              stroke="#130261" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            <path
              d="M13.24 8.2002H3.16C1.96706 8.2002 1 9.05349 1 10.1061V17.0943C1 18.1469 1.96706 19.0002 3.16 19.0002H13.24C14.4329 19.0002 15.4 18.1469 15.4 17.0943V10.1061C15.4 9.05349 14.4329 8.2002 13.24 8.2002Z"
              stroke="#130261" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </div>
        <div class="label">{{ 'account.changePassword' | translate }}</div>
        <div class="value"></div>
        <div class="chev">
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </div>
      </div>
      <div class="divider"></div>

      <!-- Đăng xuất -->
      <div class="row danger" (click)="signOut()">
        <div class="icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g opacity="0.8">
              <path
                d="M7.49719 6.37012V11.2451H14.6864L12.217 8.77527C12.0823 8.63348 12.0083 8.44466 12.0108 8.24909C12.0133 8.05352 12.0921 7.86667 12.2304 7.72836C12.3687 7.59006 12.5556 7.51126 12.7512 7.50876C12.9467 7.50625 13.1356 7.58025 13.2773 7.71496L17.0273 11.465C17.1679 11.6056 17.2468 11.7963 17.2468 11.9951C17.2468 12.1939 17.1679 12.3846 17.0273 12.5253L13.2773 16.2753C13.1356 16.41 12.9467 16.484 12.7512 16.4815C12.5556 16.479 12.3687 16.4002 12.2304 16.2619C12.0921 16.1236 12.0133 15.9367 12.0108 15.7411C12.0083 15.5456 12.0823 15.3568 12.217 15.215L14.6864 12.7451H7.49719V17.6201C7.49794 18.3161 7.77474 18.9833 8.26686 19.4755C8.75898 19.9676 9.42623 20.2444 10.1222 20.2451H19.8722C20.5682 20.2444 21.2354 19.9676 21.7275 19.4755C22.2196 18.9833 22.4964 18.3161 22.4972 17.6201V6.37012C22.4964 5.67415 22.2196 5.00691 21.7275 4.51478C21.2354 4.02266 20.5682 3.74586 19.8722 3.74512H10.1222C9.42623 3.74586 8.75898 4.02266 8.26686 4.51478C7.77474 5.00691 7.49794 5.67415 7.49719 6.37012Z"
                fill="#DD2A36" />
              <path
                d="M2.24902 11.2451C2.05011 11.2451 1.85935 11.3241 1.71869 11.4648C1.57804 11.6054 1.49902 11.7962 1.49902 11.9951C1.49902 12.194 1.57804 12.3848 1.71869 12.5254C1.85935 12.6661 2.05011 12.7451 2.24902 12.7451H7.49902V11.2451H2.24902Z"
                fill="#DD2A36" />
            </g>
          </svg>
        </div>
        <div class="label">{{ 'account.logout' | translate }}</div>
        <div class="value"></div>
        <div class="chev">
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </div>
      </div>
    </section>
  </div>
</ion-content>