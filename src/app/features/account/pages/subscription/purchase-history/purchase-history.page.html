<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button fill="clear" (click)="goBack()" aria-label="Quay lại">
        <ion-icon name="chevron-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>

    <ion-title class="ion-text-center">Lịch sử mua gói đọc</ion-title>

    <ion-buttons slot="end">
      <ion-button fill="clear" aria-label="Tùy chọn">
        <ion-icon name="ellipsis-horizontal"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- Content -->
<ion-content [fullscreen]="true">
  <div class="container">
    <!-- Greeting + Main title -->
    <section class="intro">
      <p class="hello">
        Xin chào <strong>{{ userInfo().FullName }}</strong>,
      </p>
      <h1>Lịch sử mua gói LVAI</h1>
    </section>

    <!-- Cards -->
    <section class="cards">
      <ng-container *ngFor="let e of entries(); let i = index; trackBy: trackById">
        <div class="sub-card">
          <div class="left">
            <!-- Icon bubble -->
            @switch (e.SubscriptionPlan.PlanType) {
            @case (1) {
            <div class="icon-bubble pro">
              <svg width="24" height="22" viewBox="0 0 24 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M1.43979 12.65C1.15972 12.65 0.891123 12.7611 0.693084 12.9588C0.495046 13.1565 0.383789 13.4246 0.383789 13.7042V15.8125C0.383789 16.0921 0.495046 16.3602 0.693084 16.5579C0.891123 16.7556 1.15972 16.8667 1.43979 16.8667C1.71986 16.8667 1.98846 16.7556 2.18649 16.5579C2.38453 16.3602 2.49579 16.0921 2.49579 15.8125V13.7042C2.49579 13.4246 2.38453 13.1565 2.18649 12.9588C1.98846 12.7611 1.71986 12.65 1.43979 12.65ZM22.5598 12.65C22.2797 12.65 22.0111 12.7611 21.8131 12.9588C21.615 13.1565 21.5038 13.4246 21.5038 13.7042V15.8125C21.5038 16.0921 21.615 16.3602 21.8131 16.5579C22.0111 16.7556 22.2797 16.8667 22.5598 16.8667C22.8399 16.8667 23.1085 16.7556 23.3065 16.5579C23.5045 16.3602 23.6158 16.0921 23.6158 15.8125V13.7042C23.6158 13.4246 23.5045 13.1565 23.3065 12.9588C23.1085 12.7611 22.8399 12.65 22.5598 12.65ZM17.2798 5.27083H13.0558V3.9215C13.375 3.73754 13.6404 3.47339 13.8257 3.1553C14.0109 2.83721 14.1096 2.47627 14.1118 2.10833C14.1118 1.54917 13.8893 1.01291 13.4932 0.617517C13.0971 0.222127 12.5599 0 11.9998 0C11.4397 0 10.9025 0.222127 10.5064 0.617517C10.1103 1.01291 9.88779 1.54917 9.88779 2.10833C9.89001 2.47627 9.98866 2.83721 10.1739 3.1553C10.3592 3.47339 10.6246 3.73754 10.9438 3.9215V5.27083H6.71979C5.87958 5.27083 5.07379 5.60402 4.47967 6.19711C3.88556 6.79019 3.55179 7.59459 3.55179 8.43333V17.9208C3.55179 18.7596 3.88556 19.564 4.47967 20.1571C5.07379 20.7501 5.87958 21.0833 6.71979 21.0833H17.2798C18.12 21.0833 18.9258 20.7501 19.5199 20.1571C20.114 19.564 20.4478 18.7596 20.4478 17.9208V8.43333C20.4478 7.59459 20.114 6.79019 19.5199 6.19711C18.9258 5.60402 18.12 5.27083 17.2798 5.27083ZM18.3358 17.9208C18.3358 18.2004 18.2245 18.4685 18.0265 18.6662C17.8285 18.8639 17.5599 18.975 17.2798 18.975H6.71979C6.43972 18.975 6.17112 18.8639 5.97308 18.6662C5.77505 18.4685 5.66379 18.2004 5.66379 17.9208V8.43333C5.66379 8.15375 5.77505 7.88562 5.97308 7.68793C6.17112 7.49023 6.43972 7.37917 6.71979 7.37917H8.00811L8.83179 8.878C8.88961 9.11189 9.02593 9.31896 9.21807 9.46474C9.4102 9.61051 9.64656 9.68618 9.88779 9.67917H14.1118C14.353 9.68618 14.5894 9.61051 14.7815 9.46474C14.9736 9.31896 15.11 9.11189 15.1678 8.878L15.9915 7.37917H17.2798C17.5599 7.37917 17.8285 7.49023 18.0265 7.68793C18.2245 7.88562 18.3358 8.15375 18.3358 8.43333V17.9208Z"
                  fill="url(#paint0_pro)" />
                <path
                  d="M8.25732 11.0195C8.63896 11.0196 9.00498 11.1711 9.2749 11.4404C9.54492 11.71 9.69674 12.0758 9.69678 12.457C9.69678 12.7413 9.61276 13.0195 9.45459 13.2559C9.2964 13.4922 9.07116 13.6763 8.80811 13.7852C8.54503 13.8939 8.25536 13.9226 7.97607 13.8672C7.69677 13.8117 7.44015 13.6746 7.23877 13.4736C7.03738 13.2726 6.8998 13.0162 6.84424 12.7373C6.78878 12.4586 6.8174 12.1697 6.92627 11.9072C7.03524 11.6446 7.21979 11.4197 7.45654 11.2617C7.69335 11.1038 7.97252 11.0195 8.25732 11.0195ZM15.937 11.0195C16.3189 11.0196 16.6855 11.1709 16.9556 11.4404C17.2255 11.71 17.3764 12.0759 17.3765 12.457C17.3765 12.7413 17.2925 13.0195 17.1343 13.2559C16.976 13.4923 16.7509 13.6764 16.4878 13.7852C16.2247 13.8939 15.9351 13.9226 15.6558 13.8672C15.3765 13.8117 15.1198 13.6746 14.9185 13.4736C14.7171 13.2726 14.5805 13.0161 14.5249 12.7373C14.4694 12.4585 14.498 12.1698 14.6069 11.9072C14.7159 11.6446 14.9004 11.4197 15.1372 11.2617C15.3739 11.1039 15.6523 11.0195 15.937 11.0195Z"
                  fill="url(#paint1_pro)" />
                <defs>
                  <linearGradient id="paint0_pro" x1="23.9999" y1="0.958335" x2="0.515451" y2="21.603"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#FC2D67" />
                    <stop offset="1" stop-color="#8E1FBB" />
                  </linearGradient>
                  <linearGradient id="paint1_pro" x1="17.5513" y1="11.1502" x2="15.577" y2="16.935"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#FC2D67" />
                    <stop offset="1" stop-color="#8E1FBB" />
                  </linearGradient>
                </defs>
              </svg>
            </div>
            }
            @case (2) {
            <div class="icon-bubble premium">
              <svg width="24" height="23" viewBox="0 0 24 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M4.84959 22.0713H24V19.2456L21.8043 15.1024L20.506 15.7897L22.5298 19.6083V20.6012H19.284L20.0477 11.4365H3.74219L4.84959 22.0713ZM18.463 12.9067L17.8138 20.6012H6.16702L5.3651 12.9067H18.463Z"
                  fill="url(#paint0_premium)" />
                <path
                  d="M17.1265 5.11693C17.1265 2.29116 14.8353 0 12.0095 0C9.18375 0 6.89258 2.29116 6.89258 5.11693C6.89258 7.94269 9.18375 10.2339 12.0095 10.2339C14.8353 10.2339 17.1265 7.94269 17.1265 5.11693ZM8.34366 5.11693C8.34366 3.09307 9.98567 1.45107 12.0095 1.45107C14.0334 1.45107 15.6754 3.09307 15.6754 5.11693C15.6754 7.14079 14.0334 8.78279 12.0095 8.78279C9.98567 8.78279 8.34366 7.14079 8.34366 5.11693Z"
                  fill="url(#paint1_premium)" />
                <path
                  d="M3.49404 15.8094L2.19571 15.1221L0 19.2462V22.0719H3.22674V20.6209H1.47017V19.628L3.49404 15.8094Z"
                  fill="url(#paint2_premium)" />
                <path
                  d="M11.8184 17.337C12.2402 17.337 12.5821 16.9951 12.5821 16.5733C12.5821 16.1515 12.2402 15.8096 11.8184 15.8096C11.3966 15.8096 11.0547 16.1515 11.0547 16.5733C11.0547 16.9951 11.3966 17.337 11.8184 17.337Z"
                  fill="url(#paint3_premium)" />
                <defs>
                  <linearGradient id="paint0_premium" x1="13.8711" y1="11.4365" x2="13.8711" y2="22.0713"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#E32A7A" />
                    <stop offset="1" stop-color="#A222AC" />
                  </linearGradient>
                  <linearGradient id="paint1_premium" x1="12.0095" y1="0" x2="12.0095" y2="10.2339"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#E32A7A" />
                    <stop offset="1" stop-color="#A222AC" />
                  </linearGradient>
                  <linearGradient id="paint2_premium" x1="1.74702" y1="15.1221" x2="1.74702" y2="22.0719"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#E32A7A" />
                    <stop offset="1" stop-color="#A222AC" />
                  </linearGradient>
                  <linearGradient id="paint3_premium" x1="11.8184" y1="15.8096" x2="11.8184" y2="17.337"
                    gradientUnits="userSpaceOnUse">
                    <stop stop-color="#E32A7A" />
                    <stop offset="1" stop-color="#A222AC" />
                  </linearGradient>
                </defs>
              </svg>
            </div>
            }
            @case (3) {
            <div class="icon-bubble super">
              <svg width="21" height="26" viewBox="0 0 21 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.14893 8.13379L5.77344 13.0235H0L3.14893 8.13379Z" fill="#FFECB2" />
                <path d="M3.57001 8.91824L3.14893 8.13379L0 13.0235H0.926143L3.57001 8.91824Z" fill="#EFD99C" />
                <path
                  d="M5.77344 13.0234L10.5874 25.9995L7.59056 22.3262L7.47957 22.1898L4.1617 18.1238L0 13.0234H5.77344Z"
                  fill="#FFC230" />
                <path
                  d="M8.97157 22.9983L8.86058 22.8619L5.54261 18.7959L1.38091 13.6956H6.02283L5.77344 13.0234H0L4.1617 18.1238L7.47957 22.1898L7.59056 22.3262L10.5874 25.9995L9.8929 24.1276L8.97157 22.9983Z"
                  fill="#EAAA28" />
                <path
                  d="M20.4685 13.0234L16.5268 18.199L13.4977 22.1765L13.313 22.4193L10.5864 25.9995L14.695 13.0234H20.4685Z"
                  fill="#FFC230" />
                <path
                  d="M15.1861 13.6172H20.0163L20.4685 13.0234H14.695L10.5864 25.9995L11.7488 24.4732L15.1861 13.6172Z"
                  fill="#EAAA28" />
                <path d="M17.3198 8.13379L20.4688 13.0235H14.6953L17.3198 8.13379Z" fill="#FFECB2" />
                <path d="M17.7335 8.7761L17.3198 8.13379L14.6953 13.0235H15.4537L17.7335 8.7761Z" fill="#EFD99C" />
                <path d="M17.3207 8.13379L14.6962 13.0235L9.97266 8.13379H17.3207Z" fill="#F78F4B" />
                <path
                  d="M11.3601 8.70512H17.0141L17.3207 8.13379H9.97266L14.6962 13.0235L14.9946 12.4675L11.3601 8.70512Z"
                  fill="#E27D44" />
                <path d="M9.97246 8.13379L5.77344 13.0235L3.14893 8.13379H9.97246Z" fill="#F78F4B" />
                <path
                  d="M4.15571 8.73873H9.45296L9.97246 8.13379H3.14893L5.77344 13.0235L6.19314 12.5347L4.15571 8.73873Z"
                  fill="#E27D44" />
                <path d="M9.9749 8.13379L14.6984 13.0235H5.77588L9.9749 8.13379Z" fill="#FFC230" />
                <path d="M10.443 8.61837L9.9749 8.13379L5.77588 13.0235H6.66018L10.443 8.61837Z" fill="#EAAA28" />
                <path d="M14.6984 13.0234L10.5899 25.9995L5.77588 13.0234H14.6984Z" fill="#F78F4B" />
                <path
                  d="M6.73748 13.6732H14.4927L14.6984 13.0234H5.77588L10.5899 25.9995L10.9216 24.9518L6.73748 13.6732Z"
                  fill="#F78F4B" />
                <path
                  d="M9.8959 5.16462C9.62471 5.16462 9.40479 4.96396 9.40479 4.71651V0.448104C9.40479 0.200661 9.62471 0 9.8959 0C10.1672 0 10.387 0.200661 10.387 0.448104V4.71651C10.387 4.96396 10.1672 5.16462 9.8959 5.16462Z"
                  fill="#FFC230" />
                <path
                  d="M5.88922 5.9508C5.72018 5.9508 5.55575 5.87113 5.46451 5.72845L3.86682 3.56256C3.73009 3.34882 3.80926 3.0744 4.04352 2.94974C4.27818 2.82508 4.57864 2.8974 4.71527 3.11097L6.31295 5.27685C6.44968 5.4906 6.37051 5.76501 6.13625 5.88968C6.05826 5.93108 5.9731 5.9508 5.88922 5.9508Z"
                  fill="#FFC230" />
                <path
                  d="M13.2044 5.52073C13.1606 5.37174 13.2024 5.20621 13.3298 5.08886L15.2092 3.1202C15.4001 2.94437 15.7111 2.94312 15.9037 3.11732C16.0964 3.29186 16.0976 3.57539 15.9069 3.75108L14.0275 5.71975C13.8366 5.89557 13.5256 5.89682 13.333 5.72262C13.269 5.6646 13.2261 5.59465 13.2044 5.52073Z"
                  fill="#FFC230" />
              </svg>
            </div>
            }
            @default {
            <div class="icon-bubble default">
              <div class="icon-bubble-inner">
                <ion-icon name="book-outline"></ion-icon>
              </div>
            </div>
            }
            }


            <!-- Text block -->
            <div class="text">
              <div class="plan-title">{{ e.SubscriptionPlan.Name }}</div>
              <div class="line">
                <span class="muted">{{ e.SubscriptionPlan.PlanType===0 ? 'Miễn phí' : 'Hội viên' }}:</span>
                <strong>{{ e.SubscriptionPlan.PlanType===0 ? '30 ngày' : '1 năm' }}</strong>
              </div>
              <div class="line">
                <span class="muted">Ngày bắt đầu:</span>
                <strong>{{ e.StartDate | date:'dd/MM/yyyy' }}</strong>
              </div>
              <div class="line">
                <span class="muted">Ngày hết hạn:</span>
                <strong>{{ e.EndDate | date:'dd/MM/yyyy' }}</strong>
              </div>
            </div>
          </div>

          <!-- Status pill -->
          <div class="status" [class.expired]="e.IsActive===false" [class.active]="e.IsActive===true">
            {{ e.IsActive===false ? 'Hết hạn' : 'Đang sử dụng' }}
          </div>
        </div>

        <!-- Divider giữa 2 thẻ như thiết kế -->
        <div class="section-divider"></div>
      </ng-container>
    </section>
  </div>
</ion-content>