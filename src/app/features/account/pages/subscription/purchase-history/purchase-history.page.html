<app-header
  [title]="'purchaseHistory.title' | translate"
  [showBackButton]="true"
></app-header>

<!-- Content -->
<ion-content [fullscreen]="true">
  <div class="container">
    <!-- Greeting + Main title -->
    <section class="intro">
      <p class="fs-16 color-violet">
        {{ 'purchaseHistory.hello' | translate }}
        <strong>{{ userInfo().FullName }}</strong>,
      </p>
      <h1 class="fs-28 font-weight-700 color-violet">
        {{ 'purchaseHistory.heading' | translate }}
      </h1>
    </section>

    <!-- Cards -->
    <section class="margin-top-30">
      <ng-container
        *ngFor="let e of entries(); let i = index; trackBy: trackById"
      >
        <div class="sub-card" (click)="goToOrderDetail(e.UserSubscriptionId)">
          <div class="left">
            <!-- Icon bubble -->
            @switch (e.SubscriptionPlan.PlanType) { @case (1) {
            <div class="icon-bubble pro">
              <svg
                width="24"
                height="22"
                viewBox="0 0 24 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M1.43979 12.65C1.15972 12.65 0.891123 12.7611 0.693084 12.9588C0.495046 13.1565 0.383789 13.4246 0.383789 13.7042V15.8125C0.383789 16.0921 0.495046 16.3602 0.693084 16.5579C0.891123 16.7556 1.15972 16.8667 1.43979 16.8667C1.71986 16.8667 1.98846 16.7556 2.18649 16.5579C2.38453 16.3602 2.49579 16.0921 2.49579 15.8125V13.7042C2.49579 13.4246 2.38453 13.1565 2.18649 12.9588C1.98846 12.7611 1.71986 12.65 1.43979 12.65ZM22.5598 12.65C22.2797 12.65 22.0111 12.7611 21.8131 12.9588C21.615 13.1565 21.5038 13.4246 21.5038 13.7042V15.8125C21.5038 16.0921 21.615 16.3602 21.8131 16.5579C22.0111 16.7556 22.2797 16.8667 22.5598 16.8667C22.8399 16.8667 23.1085 16.7556 23.3065 16.5579C23.5045 16.3602 23.6158 16.0921 23.6158 15.8125V13.7042C23.6158 13.4246 23.5045 13.1565 23.3065 12.9588C23.1085 12.7611 22.8399 12.65 22.5598 12.65ZM17.2798 5.27083H13.0558V3.9215C13.375 3.73754 13.6404 3.47339 13.8257 3.1553C14.0109 2.83721 14.1096 2.47627 14.1118 2.10833C14.1118 1.54917 13.8893 1.01291 13.4932 0.617517C13.0971 0.222127 12.5599 0 11.9998 0C11.4397 0 10.9025 0.222127 10.5064 0.617517C10.1103 1.01291 9.88779 1.54917 9.88779 2.10833C9.89001 2.47627 9.98866 2.83721 10.1739 3.1553C10.3592 3.47339 10.6246 3.73754 10.9438 3.9215V5.27083H6.71979C5.87958 5.27083 5.07379 5.60402 4.47967 6.19711C3.88556 6.79019 3.55179 7.59459 3.55179 8.43333V17.9208C3.55179 18.7596 3.88556 19.564 4.47967 20.1571C5.07379 20.7501 5.87958 21.0833 6.71979 21.0833H17.2798C18.12 21.0833 18.9258 20.7501 19.5199 20.1571C20.114 19.564 20.4478 18.7596 20.4478 17.9208V8.43333C20.4478 7.59459 20.114 6.79019 19.5199 6.19711C18.9258 5.60402 18.12 5.27083 17.2798 5.27083ZM18.3358 17.9208C18.3358 18.2004 18.2245 18.4685 18.0265 18.6662C17.8285 18.8639 17.5599 18.975 17.2798 18.975H6.71979C6.43972 18.975 6.17112 18.8639 5.97308 18.6662C5.77505 18.4685 5.66379 18.2004 5.66379 17.9208V8.43333C5.66379 8.15375 5.77505 7.88562 5.97308 7.68793C6.17112 7.49023 6.43972 7.37917 6.71979 7.37917H8.00811L8.83179 8.878C8.88961 9.11189 9.02593 9.31896 9.21807 9.46474C9.4102 9.61051 9.64656 9.68618 9.88779 9.67917H14.1118C14.353 9.68618 14.5894 9.61051 14.7815 9.46474C14.9736 9.31896 15.11 9.11189 15.1678 8.878L15.9915 7.37917H17.2798C17.5599 7.37917 17.8285 7.49023 18.0265 7.68793C18.2245 7.88562 18.3358 8.15375 18.3358 8.43333V17.9208Z"
                  fill="url(#paint0_pro)"
                />
                <path
                  d="M8.25732 11.0195C8.63896 11.0196 9.00498 11.1711 9.2749 11.4404C9.54492 11.71 9.69674 12.0758 9.69678 12.457C9.69678 12.7413 9.61276 13.0195 9.45459 13.2559C9.2964 13.4922 9.07116 13.6763 8.80811 13.7852C8.54503 13.8939 8.25536 13.9226 7.97607 13.8672C7.69677 13.8117 7.44015 13.6746 7.23877 13.4736C7.03738 13.2726 6.8998 13.0162 6.84424 12.7373C6.78878 12.4586 6.8174 12.1697 6.92627 11.9072C7.03524 11.6446 7.21979 11.4197 7.45654 11.2617C7.69335 11.1038 7.97252 11.0195 8.25732 11.0195ZM15.937 11.0195C16.3189 11.0196 16.6855 11.1709 16.9556 11.4404C17.2255 11.71 17.3764 12.0759 17.3765 12.457C17.3765 12.7413 17.2925 13.0195 17.1343 13.2559C16.976 13.4923 16.7509 13.6764 16.4878 13.7852C16.2247 13.8939 15.9351 13.9226 15.6558 13.8672C15.3765 13.8117 15.1198 13.6746 14.9185 13.4736C14.7171 13.2726 14.5805 13.0161 14.5249 12.7373C14.4694 12.4585 14.498 12.1698 14.6069 11.9072C14.7159 11.6446 14.9004 11.4197 15.1372 11.2617C15.3739 11.1039 15.6523 11.0195 15.937 11.0195Z"
                  fill="url(#paint1_pro)"
                />
                <defs>
                  <linearGradient
                    id="paint0_pro"
                    x1="23.9999"
                    y1="0.958335"
                    x2="0.515451"
                    y2="21.603"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#FC2D67" />
                    <stop offset="1" stop-color="#8E1FBB" />
                  </linearGradient>
                  <linearGradient
                    id="paint1_pro"
                    x1="17.5513"
                    y1="11.1502"
                    x2="15.577"
                    y2="16.935"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#FC2D67" />
                    <stop offset="1" stop-color="#8E1FBB" />
                  </linearGradient>
                </defs>
              </svg>
            </div>
            } @case (2) {
            <div class="icon-bubble premium">
              <svg
                width="24"
                height="23"
                viewBox="0 0 24 23"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M4.84959 22.0713H24V19.2456L21.8043 15.1024L20.506 15.7897L22.5298 19.6083V20.6012H19.284L20.0477 11.4365H3.74219L4.84959 22.0713ZM18.463 12.9067L17.8138 20.6012H6.16702L5.3651 12.9067H18.463Z"
                  fill="url(#paint0_premium)"
                />
                <path
                  d="M17.1265 5.11693C17.1265 2.29116 14.8353 0 12.0095 0C9.18375 0 6.89258 2.29116 6.89258 5.11693C6.89258 7.94269 9.18375 10.2339 12.0095 10.2339C14.8353 10.2339 17.1265 7.94269 17.1265 5.11693ZM8.34366 5.11693C8.34366 3.09307 9.98567 1.45107 12.0095 1.45107C14.0334 1.45107 15.6754 3.09307 15.6754 5.11693C15.6754 7.14079 14.0334 8.78279 12.0095 8.78279C9.98567 8.78279 8.34366 7.14079 8.34366 5.11693Z"
                  fill="url(#paint1_premium)"
                />
                <path
                  d="M3.49404 15.8094L2.19571 15.1221L0 19.2462V22.0719H3.22674V20.6209H1.47017V19.628L3.49404 15.8094Z"
                  fill="url(#paint2_premium)"
                />
                <path
                  d="M11.8184 17.337C12.2402 17.337 12.5821 16.9951 12.5821 16.5733C12.5821 16.1515 12.2402 15.8096 11.8184 15.8096C11.3966 15.8096 11.0547 16.1515 11.0547 16.5733C11.0547 16.9951 11.3966 17.337 11.8184 17.337Z"
                  fill="url(#paint3_premium)"
                />
                <defs>
                  <linearGradient
                    id="paint0_premium"
                    x1="13.8711"
                    y1="11.4365"
                    x2="13.8711"
                    y2="22.0713"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#E32A7A" />
                    <stop offset="1" stop-color="#A222AC" />
                  </linearGradient>
                  <linearGradient
                    id="paint1_premium"
                    x1="12.0095"
                    y1="0"
                    x2="12.0095"
                    y2="10.2339"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#E32A7A" />
                    <stop offset="1" stop-color="#A222AC" />
                  </linearGradient>
                  <linearGradient
                    id="paint2_premium"
                    x1="1.74702"
                    y1="15.1221"
                    x2="1.74702"
                    y2="22.0719"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#E32A7A" />
                    <stop offset="1" stop-color="#A222AC" />
                  </linearGradient>
                  <linearGradient
                    id="paint3_premium"
                    x1="11.8184"
                    y1="15.8096"
                    x2="11.8184"
                    y2="17.337"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#E32A7A" />
                    <stop offset="1" stop-color="#A222AC" />
                  </linearGradient>
                </defs>
              </svg>
            </div>
            } @case (3) {
            <div class="icon-bubble">
              <svg
                width="40"
                height="32"
                viewBox="0 0 46 46"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <rect
                  width="46"
                  height="46"
                  rx="15"
                  fill="url(#paint0_linear_55183_1648)"
                />
                <path
                  d="M16.1489 18.1338L18.7734 23.0235H13L16.1489 18.1338Z"
                  fill="#FFECB2"
                />
                <path
                  d="M16.57 18.9182L16.1489 18.1338L13 23.0235H13.9261L16.57 18.9182Z"
                  fill="#EFD99C"
                />
                <path
                  d="M18.7734 23.0239L23.5874 36L20.5906 32.3266L20.4796 32.1902L17.1617 28.1242L13 23.0239H18.7734Z"
                  fill="#FFC230"
                />
                <path
                  d="M21.9716 32.9988L21.8606 32.8624L18.5426 28.7964L14.3809 23.6961H19.0228L18.7734 23.0239H13L17.1617 28.1242L20.4796 32.1902L20.5906 32.3266L23.5874 36L22.8929 34.1281L21.9716 32.9988Z"
                  fill="#EAAA28"
                />
                <path
                  d="M33.4685 23.0239L29.5268 28.1995L26.4977 32.177L26.313 32.4198L23.5864 36L27.695 23.0239H33.4685Z"
                  fill="#FFC230"
                />
                <path
                  d="M28.1861 23.6177H33.0163L33.4685 23.0239H27.695L23.5864 36L24.7488 34.4737L28.1861 23.6177Z"
                  fill="#EAAA28"
                />
                <path
                  d="M30.3198 18.1338L33.4688 23.0235H27.6953L30.3198 18.1338Z"
                  fill="#FFECB2"
                />
                <path
                  d="M30.7335 18.7761L30.3198 18.1338L27.6953 23.0235H28.4537L30.7335 18.7761Z"
                  fill="#EFD99C"
                />
                <path
                  d="M30.3207 18.1338L27.6962 23.0235L22.9727 18.1338H30.3207Z"
                  fill="#F78F4B"
                />
                <path
                  d="M24.3601 18.7051H30.0141L30.3207 18.1338H22.9727L27.6962 23.0235L27.9946 22.4675L24.3601 18.7051Z"
                  fill="#E27D44"
                />
                <path
                  d="M22.9725 18.1338L18.7734 23.0235L16.1489 18.1338H22.9725Z"
                  fill="#F78F4B"
                />
                <path
                  d="M17.1557 18.7387H22.453L22.9725 18.1338H16.1489L18.7734 23.0235L19.1931 22.5347L17.1557 18.7387Z"
                  fill="#E27D44"
                />
                <path
                  d="M22.9749 18.1338L27.6984 23.0235H18.7759L22.9749 18.1338Z"
                  fill="#FFC230"
                />
                <path
                  d="M23.443 18.6184L22.9749 18.1338L18.7759 23.0235H19.6602L23.443 18.6184Z"
                  fill="#EAAA28"
                />
                <path
                  d="M27.6984 23.0239L23.5899 36L18.7759 23.0239H27.6984Z"
                  fill="#F78F4B"
                />
                <path
                  d="M19.7375 23.6737H27.4927L27.6984 23.0239H18.7759L23.5899 36L23.9216 34.9523L19.7375 23.6737Z"
                  fill="#F78F4B"
                />
                <path
                  d="M22.8959 15.1646C22.6247 15.1646 22.4048 14.964 22.4048 14.7165V10.4481C22.4048 10.2007 22.6247 10 22.8959 10C23.1672 10 23.387 10.2007 23.387 10.4481V14.7165C23.387 14.964 23.1672 15.1646 22.8959 15.1646Z"
                  fill="#FFC230"
                />
                <path
                  d="M18.8892 15.9508C18.7202 15.9508 18.5558 15.8711 18.4645 15.7284L16.8668 13.5626C16.7301 13.3488 16.8093 13.0744 17.0435 12.9497C17.2782 12.8251 17.5786 12.8974 17.7153 13.111L19.313 15.2769C19.4497 15.4906 19.3705 15.765 19.1362 15.8897C19.0583 15.9311 18.9731 15.9508 18.8892 15.9508Z"
                  fill="#FFC230"
                />
                <path
                  d="M26.2044 15.5212C26.1606 15.3722 26.2024 15.2067 26.3298 15.0894L28.2092 13.1207C28.4001 12.9449 28.7111 12.9436 28.9037 13.1178C29.0964 13.2924 29.0976 13.5759 28.9069 13.7516L27.0275 15.7202C26.8366 15.8961 26.5256 15.8973 26.333 15.7231C26.269 15.6651 26.2261 15.5951 26.2044 15.5212Z"
                  fill="#FFC230"
                />
                <defs>
                  <linearGradient
                    id="paint0_linear_55183_1648"
                    x1="53.5"
                    y1="-1.35827e-06"
                    x2="12"
                    y2="46"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#E19A88" />
                    <stop offset="1" stop-color="#6D3476" />
                  </linearGradient>
                </defs>
              </svg>
            </div>
            } @default {
            <div class="icon-bubble default">
              <div class="icon-bubble-inner">
                <ion-icon name="book-outline"></ion-icon>
              </div>
            </div>
            } }
            <!-- Text block -->
            <div class="text">
              <div class="fs-18 font-weight-500 color-violet">
                {{ e.SubscriptionPlan.Name }}
              </div>
              <div class="line">
                <span class="color-light-gray fs-14 font-weight-400"
                  >{{ (e.SubscriptionPlan.PlanType===0 ?
                  'purchaseHistory.plan.free' : 'purchaseHistory.plan.member') |
                  translate }}:</span
                >
                <span class="color-violet fs-14 font-weight-500">
                  {{ e.SubscriptionPlan.PlanType===0 ? '30 ngày' : '1 năm'
                  }}</span
                >
              </div>
              <div class="line">
                <span class="color-light-gray fs-14 font-weight-400"
                  >{{ 'purchaseHistory.startDate' | translate }}:</span
                >
                <span class="color-violet fs-14 font-weight-500">
                  {{ e.StartDate | date:'dd/MM/yyyy' }}</span
                >
              </div>
              <div class="line">
                <span class="color-light-gray fs-14 font-weight-400"
                  >{{ 'purchaseHistory.endDate' | translate }}:</span
                >
                <span class="color-violet fs-14 font-weight-500">
                  {{ e.EndDate | date:'dd/MM/yyyy' }}</span
                >
              </div>
            </div>
          </div>

          <!-- Status pill -->
          <div class="status {{e.IsActive ? 'active' : 'expired'}}">
            {{ (e.IsActive ? 'purchaseHistory.status.active' :
            'purchaseHistory.status.expired') | translate }}
          </div>
        </div>

        <!-- Divider giữa 2 thẻ như thiết kế -->
        <div class="section-divider"></div>
      </ng-container>
    </section>
  </div>
</ion-content>
