<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button fill="clear" (click)="goBack()" aria-label="Quay lại">
        <ion-icon name="chevron-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title class="ion-text-center">Đọc sách</ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear" aria-label="Tùy chọn">
        <ion-icon name="bookmark-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
  <div class="thin-divider"></div>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="shell">
    <!-- HERO: bìa + tiêu đề + NXB + rating -->
    <section class="layers"
      [style.backgroundImage]="'linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.9)), url(/assets/imgs/demo/1.png)'">
      <div class="cover-card ion-align-items-center">
        <img src="../../../assets/imgs/demo/1.png" [alt]="title" />
      </div>

      <div class="meta">
        <h1 class="book-title">{{ title }}</h1>
        <div class="publisher">
          <u>{{ publisher }}</u>
        </div>
        <div class="rating">
          <div class="stars">
            <ion-icon name="star"></ion-icon>
            <ion-icon name="star"></ion-icon>
            <ion-icon name="star"></ion-icon>
            <ion-icon name="star-half-outline"></ion-icon>
            <ion-icon name="star-outline"></ion-icon>
          </div>
          <div class="count">({{ ratingCount }})</div>
        </div>
      </div>

      <!-- CTA: ĐỌC SÁCH + nút tròn gradient -->
      <div class="cta-row">
        <button class="gradient-btn" (click)="readNow()">ĐỌC SÁCH</button>
        <button class="round-btn" (click)="chat()" aria-label="Hành động phụ">
          <svg width="35" height="30" viewBox="0 0 30 27" fill="none" xmlns="http://www.w3.org/2000/svg">
            <!-- Hình vali -->
            <path
              d="M1.79998 15.95C1.44989 15.95 1.11415 16.09 0.8666 16.3393C0.619051 16.5886 0.47998 16.9267 0.47998 17.2792V19.9375C0.47998 20.29 0.619051 20.6281 0.8666 20.8774C1.11415 21.1266 1.44989 21.2667 1.79998 21.2667C2.15007 21.2667 2.48581 21.1266 2.73336 20.8774C2.98091 20.6281 3.11998 20.29 3.11998 19.9375V17.2792C3.11998 16.9267 2.98091 16.5886 2.73336 16.3393C2.48581 16.09 2.15007 15.95 1.79998 15.95ZM28.2 15.95C27.8499 15.95 27.5141 16.09 27.2666 16.3393C27.0191 16.5886 26.88 16.9267 26.88 17.2792V19.9375C26.88 20.29 27.0191 20.6281 27.2666 20.8774C27.5141 21.1266 27.8499 21.2667 28.2 21.2667C28.5501 21.2667 28.8858 21.1266 29.1334 20.8774C29.3809 20.6281 29.52 20.29 29.52 19.9375V17.2792C29.52 16.9267 29.3809 16.5886 29.1334 16.3393C28.8858 16.09 28.5501 15.95 28.2 15.95ZM21.6 6.64583H16.32V4.9445C16.719 4.71255 17.0508 4.37949 17.2823 3.97842C17.5139 3.57736 17.6372 3.12225 17.64 2.65833C17.64 1.9533 17.3618 1.27714 16.8667 0.778608C16.3716 0.280074 15.7002 0 15 0C14.2998 0 13.6283 0.280074 13.1332 0.778608C12.6381 1.27714 12.36 1.9533 12.36 2.65833C12.3628 3.12225 12.4861 3.57736 12.7176 3.97842C12.9492 4.37949 13.281 4.71255 13.68 4.9445V6.64583H8.39998C7.34972 6.64583 6.34248 7.06594 5.59984 7.81375C4.85719 8.56155 4.43998 9.57578 4.43998 10.6333V22.5958C4.43998 23.6534 4.85719 24.6676 5.59984 25.4154C6.34248 26.1632 7.34972 26.5833 8.39998 26.5833H21.6C22.6502 26.5833 23.6575 26.1632 24.4001 25.4154C25.1428 24.6676 25.56 23.6534 25.56 22.5958V10.6333C25.56 9.57578 25.1428 8.56155 24.4001 7.81375C23.6575 7.06594 22.6502 6.64583 21.6 6.64583ZM22.92 22.5958C22.92 22.9484 22.7809 23.2864 22.5334 23.5357C22.2858 23.785 21.9501 23.925 21.6 23.925H8.39998C8.0499 23.925 7.71415 23.785 7.4666 23.5357C7.21905 23.2864 7.07998 22.9484 7.07998 22.5958V10.6333C7.07998 10.2808 7.21905 9.94274 7.4666 9.69347C7.71415 9.4442 8.0499 9.30417 8.39998 9.30417H10.0104L11.04 11.194C11.1123 11.4889 11.2827 11.75 11.5228 11.9338C11.763 12.1176 12.0584 12.213 12.36 12.2042H17.64C17.9415 12.213 18.237 12.1176 18.4771 11.9338C18.7173 11.75 18.8877 11.4889 18.96 11.194L19.9896 9.30417H21.6C21.9501 9.30417 22.2858 9.4442 22.5334 9.69347C22.7809 9.94274 22.92 10.2808 22.92 10.6333V22.5958Z"
              fill="url(#paint0_linear_54968_8836)" />

            <!-- SVG con (hai chấm) đặt giữa vali -->
            <svg x="8" y="12" width="14" height="5" viewBox="0 0 14 5">
              <path
                d="M2.32138 0.894531C2.79859 0.894544 3.25632 1.08513 3.59384 1.4248C3.93141 1.76471 4.12119 2.22633 4.12119 2.70703C4.12115 3.06537 4.01613 3.41589 3.81845 3.71387C3.62067 4.01193 3.33877 4.24465 3.00986 4.38184C2.68106 4.51888 2.31884 4.55428 1.96982 4.48438C1.62084 4.4144 1.30056 4.24163 1.04892 3.98828C0.7972 3.73481 0.625218 3.41212 0.555758 3.06055C0.486332 2.70909 0.522191 2.34476 0.658298 2.01367C0.794516 1.68253 1.02543 1.39935 1.32138 1.2002C1.61739 1.00104 1.96538 0.894531 2.32138 0.894531ZM11.921 0.894531C12.3984 0.894531 12.8569 1.08493 13.1944 1.4248C13.532 1.76471 13.7218 2.22633 13.7218 2.70703C13.7217 3.06544 13.6158 3.41585 13.4181 3.71387C13.2203 4.01191 12.9393 4.24465 12.6104 4.38184C12.2816 4.51899 11.9195 4.55426 11.5704 4.48438C11.2212 4.41444 10.9003 4.24176 10.6485 3.98828C10.3969 3.73485 10.2258 3.41202 10.1563 3.06055C10.0869 2.70914 10.1218 2.34472 10.2579 2.01367C10.3941 1.68263 10.6252 1.39934 10.921 1.2002C11.2169 1.0011 11.5651 0.894599 11.921 0.894531Z"
                fill="url(#paint0_linear_54968_8837)" />
            </svg>

            <!-- Định nghĩa gradient -->
            <defs>
              <linearGradient id="paint0_linear_54968_8836" x1="30.0001" y1="1.20834" x2="0.423224" y2="26.9845"
                gradientUnits="userSpaceOnUse">
                <stop stop-color="#FC2D67" />
                <stop offset="1" stop-color="#8E1FBB" />
              </linearGradient>
              <linearGradient id="paint0_linear_54968_8837" x1="13.94" y1="1.0593" x2="11.4343" y2="8.3392"
                gradientUnits="userSpaceOnUse">
                <stop stop-color="#FC2D67" />
                <stop offset="1" stop-color="#8E1FBB" />
              </linearGradient>
            </defs>
          </svg>

        </button>
      </div>
    </section>

    <!-- TÓM TẮT -->
    <section class="section">
      <div class="section-head">
        <h2>Tóm tắt nội dung</h2>
      </div>
      <pre class="summary">{{ summary() }}</pre>
      <button class="see-more" type="button" (click)="toggleExpanded()">
        {{ expanded() ? 'Thu gọn' : 'Xem tiếp...' }}
      </button>
    </section>

    <!-- SỐ CÙNG TẠP CHÍ -->
    <section class="section">
      <div class="section-row">
        <h2>Số cùng tạp chí</h2>
        <button class="link" type="button">Tất cả</button>
      </div>

      <div class="issue-strip">
        <div class="issue" *ngFor="let it of issues">
          <div class="thumb">
            <img [src]="it.cover" [alt]="it.title" />
          </div>
          <div class="issue-meta">
            <div class="issue-title">{{ it.title }}</div>
            <button class="read-chip" (click)="readIssue(it.id)">
              <div class="content">
                <span>ĐỌC SÁCH</span>
              </div>
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- BÌNH LUẬN -->
    <section class="section">
      <div class="section-row">
        <h2>Bình luận bạn đọc</h2>
        <button class="link" type="button">Tất cả</button>
      </div>

      <div class="comments">
        <div class="comment-card" *ngFor="let c of comments">
          <div class="c-head">
            <img [src]="c.avatar" alt="" class="avatar" />
            <div class="who">
              <div class="name">{{ c.name }}</div>
              <div class="time">{{ c.time }}</div>
            </div>
          </div>
          <div class="c-body">{{ c.content }}</div>
        </div>
      </div>
    </section>
  </div>
</ion-content>